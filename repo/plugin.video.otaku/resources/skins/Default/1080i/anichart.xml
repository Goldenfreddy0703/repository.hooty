<!--
╔═══════════════════════════════════════════════════════════════════════════╗
║                    ANIME CALENDAR (ANICHART) WINDOW                       ║
║                                                                           ║
║  This XML defines the anime calendar UI with:                            ║
║  - Background layers with fanart                                          ║
║  - Panel list (ID: 1000) showing anime cards                             ║
║  - Two layouts: itemlayout (unfocused) & focusedlayout (focused)         ║
║                                                                           ║
║  KEY COMPONENTS:                                                          ║
║  1. Background Section (lines ~8-50)                                      ║
║  2. Panel Control (ID: 1000) - Main anime list (lines ~60-1200)          ║
║     ├── itemlayout (unfocused cards)                                      ║
║     └── focusedlayout (focused card with animations)                      ║
║                                                                           ║
║  EACH CARD DISPLAYS:                                                      ║
║  - Poster image (260x370px)                                               ║
║  - Vertical ratings bar (Average, MAL, AniList, IMDb, Trakt, TMDb)       ║
║  - Title, Episode info (Raw/Sub/Dub), Countdown timers                   ║
║  - Plot description, Genres                                               ║
╚═══════════════════════════════════════════════════════════════════════════╝
-->

<window type="dialog">
    <defaultcontrol>1000</defaultcontrol>
    <coordinates>
        <left>0</left>
        <top>0</top>
    </coordinates>
    <controls>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- SECTION 1: BACKGROUND LAYERS                                     -->
        <!-- ═══════════════════════════════════════════════════════════════ -->

        <!-- Black base layer -->
        <control type="image">
            <texture>white.png</texture>
            <colordiffuse>FF000000</colordiffuse>
        </control>

        <!-- Fanart background (from Window Property) -->
        <control type="image">
            <top>0</top>
            <left>0</left>
            <width>1920</width>
            <height>1080</height>
            <texture background="true">$INFO[Window().Property(otaku.fanart)]</texture>
        </control>

        <!-- Dark overlay on fanart (80% opacity) -->
        <control type="image">
            <top>0</top>
            <left>0</left>
            <width>1920</width>
            <height>1080</height>
            <texture background="true">white.png</texture>
            <colordiffuse>CC000000</colordiffuse>
        </control>

        <!-- Otaku Logo (hidden off-screen with negative top) -->
        <control type="image" id="1001">
            <top>-990</top>
            <left>913</left>
            <width>75</width>
            <aspectratio>keep</aspectratio>
            <texture>$INFO[Window().Property(otaku.logo)]</texture>
        </control>

        <!-- Panel container background -->
        <control type="image">
            <visible>true</visible>
            <left>120</left>
            <top>100</top>
            <width>1600</width>
            <height>900</height>
            <border>5</border>
            <texture>white.png</texture>
            <colordiffuse>88000000</colordiffuse>
        </control>


        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- SECTION 2: MAIN ANIME PANEL (ID: 1000)                          -->
        <!-- Navigation: Left=9000, Right=60, Up/Down=52                     -->
        <!-- Contains itemlayout & focusedlayout for anime cards             -->
        <!-- ═══════════════════════════════════════════════════════════════ -->

        <control type="panel" id="1000">
            <left>120</left>
            <top>100</top>
            <width>1700</width>
            <height>900</height>
            <onleft>9000</onleft>
            <onright>60</onright>
            <onup>52</onup>
            <ondown>52</ondown>
            <scrolltime tween="sine" easing="out">200</scrolltime>
            <autoscroll>true</autoscroll>
            <viewtype label="Sources">icon</viewtype>
            <pagecontrol>60</pagecontrol>

            <!-- ───────────────────────────────────────────────────────────── -->
            <!-- ITEMLAYOUT: Unfocused anime card (390px height x 800px width) -->
            <!-- ───────────────────────────────────────────────────────────── -->
            <itemlayout height="390" width="800">

                <!-- ▼ POSTER IMAGE (260x370px, left side) ▼ -->
                <control type="image">
                    <left>10</left>
                    <top>10</top>
                    <width>260</width>
                    <height>370</height>
                    <texture>$INFO[ListItem.Property(poster)]</texture>
                </control>

                <!-- ▼ VERTICAL RATINGS BAR (overlays left side of poster) ▼ -->
                <control type="group">
                    <left>10</left>
                    <top>10</top>
                    <width>50</width>
                    <height>390</height>

                    <!-- Dark background for ratings -->
                    <control type="image">
                        <left>0</left>
                        <top>0</top>
                        <width>50</width>
                        <height>370</height>
                        <texture>white.png</texture>
                        <colordiffuse>CC000000</colordiffuse>
                    </control>

                    <!-- ★ Rating #1: Average Score (0-100%, top position) ★ -->
                    <control type="group">
                        <left>0</left>
                        <top>5</top>
                        <width>50</width>
                        <height>60</height>

                        <!-- Emoji icon (changes based on score) -->
                        <!-- Happy face: 75%+ -->
                        <control type="image">
                            <visible>Integer.IsGreaterOrEqual(ListItem.Property(rating_average),75)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.aver)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <!-- Straight face: 61-74% -->
                        <control type="image">
                            <visible>Integer.IsGreater(ListItem.Property(rating_average),60) + Integer.IsLess(ListItem.Property(rating_average),75)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.averstr)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <control type="image">
                            <visible>Integer.IsGreater(ListItem.Property(rating_average),0) + Integer.IsLessOrEqual(ListItem.Property(rating_average),60)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.aversad)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <control type="image">
                            <visible>Integer.IsEqual(ListItem.Property(rating_average),0) | IsEmpty(ListItem.Property(rating_average))</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.avernone)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <!-- Score label -->
                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_average)]</label>
                        </control>
                    </control>

                    <!-- MAL Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>65</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.mal)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_mal)]</label>
                        </control>
                    </control>

                    <!-- Anilist Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>125</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.anilist)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_anilist)]</label>
                        </control>
                    </control>

                    <!-- IMDb Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>185</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.imdb)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_imdb)]</label>
                        </control>
                    </control>

                    <!-- Trakt Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>245</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.trakt)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_trakt)]</label>
                        </control>
                    </control>

                    <!-- TMDb Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>305</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.tmdb)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_tmdb)]</label>
                        </control>
                    </control>
                </control>

                <!-- Release Title -->
                <control type="label">
                    <left>300</left>
                    <top>0</top>
                    <width>450</width>
                    <height>35</height>
                    <font>font16</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>left</align>
                    <scroll>true</scroll>
                    <autoscroll delay="4000" time="1500" repeat="5000" />
                    <label>[B]$INFO[ListItem.Property(release_title)][/B]</label>
                </control>

                <!-- ===== Added: compact episodes row (Raw | Sub | Dub) ===== -->
                <control type="group">
                    <visible>
                    Integer.IsGreater(ListItem.Property(raw_episode),0) |
                    Integer.IsGreater(ListItem.Property(sub_episode),0) |
                    Integer.IsGreater(ListItem.Property(dub_episode),0)
                    </visible>
                    <left>300</left>
                    <top>40</top>
                    <width>450</width>
                    <height>70</height>

                    <!-- RAW -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(raw_episode),0)</visible>
                        <left>0</left>
                        <top>0</top>
                        <width>150</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>150</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF53b56f</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(raw_episode)] Raw[/B]</label>
                        </control>
                        <!-- time under title -->
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(raw_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>150</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(raw_time)]</label>
                        </control>
                    </control>

                    <!-- Separator RAW|SUB -->
                    <control type="image">
                        <visible>Integer.IsGreater(ListItem.Property(raw_episode),0) + Integer.IsGreater(ListItem.Property(sub_episode),0)</visible>
                        <left>150</left>
                        <top>0</top>
                        <width>2</width>
                        <height>42</height>
                        <texture>white.png</texture>
                        <colordiffuse>33FFFFFF</colordiffuse>
                    </control>

                    <!-- SUB -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(sub_episode),0)</visible>
                        <left>152</left>
                        <top>0</top>
                        <width>150</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>150</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF2fb2ff</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(sub_episode)] Sub[/B]</label>
                        </control>
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(sub_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>150</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(sub_time)]</label>
                        </control>
                    </control>

                    <!-- Separator SUB|DUB -->
                    <control type="image">
                        <visible>Integer.IsGreater(ListItem.Property(sub_episode),0) + Integer.IsGreater(ListItem.Property(dub_episode),0)</visible>
                        <left>302</left>
                        <top>0</top>
                        <width>2</width>
                        <height>42</height>
                        <texture>white.png</texture>
                        <colordiffuse>33FFFFFF</colordiffuse>
                    </control>

                    <!-- DUB -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(dub_episode),0)</visible>
                        <left>304</left>
                        <top>0</top>
                        <width>146</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>146</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF9fd33a</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(dub_episode)] Dub[/B]</label>
                        </control>
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(dub_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>146</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(dub_time)]</label>
                        </control>
                    </control>

                    <!-- Single day and date below all three columns with fallback: raw → sub → dub -->
                    <!-- RAW day/date (primary) -->
                    <control type="label">
                        <visible>!String.IsEmpty(ListItem.Property(raw_day)) + !String.IsEqual(ListItem.Property(raw_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(raw_day)] $INFO[ListItem.Property(raw_date_formatted)]</label>
                    </control>
                    <!-- SUB day/date (fallback if no raw) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_day)) | String.IsEqual(ListItem.Property(raw_day),TBA)] + !String.IsEmpty(ListItem.Property(sub_day)) + !String.IsEqual(ListItem.Property(sub_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(sub_day)] $INFO[ListItem.Property(sub_date_formatted)]</label>
                    </control>
                    <!-- DUB day/date (fallback if no raw or sub) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_day)) | String.IsEqual(ListItem.Property(raw_day),TBA)] + [String.IsEmpty(ListItem.Property(sub_day)) | String.IsEqual(ListItem.Property(sub_day),TBA)] + !String.IsEmpty(ListItem.Property(dub_day)) + !String.IsEqual(ListItem.Property(dub_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(dub_day)] $INFO[ListItem.Property(dub_date_formatted)]</label>
                    </control>

                    <!-- Countdown beside date with fallback: raw → sub → dub -->
                    <!-- RAW countdown (primary) -->
                    <control type="label">
                        <visible>!String.IsEmpty(ListItem.Property(raw_countdown)) + !String.IsEqual(ListItem.Property(raw_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(raw_countdown)]</label>
                    </control>
                    <!-- SUB countdown (fallback if no raw) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_countdown)) | String.IsEqual(ListItem.Property(raw_countdown),TBA)] + !String.IsEmpty(ListItem.Property(sub_countdown)) + !String.IsEqual(ListItem.Property(sub_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(sub_countdown)]</label>
                    </control>
                    <!-- DUB countdown (fallback if no raw or sub) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_countdown)) | String.IsEqual(ListItem.Property(raw_countdown),TBA)] + [String.IsEmpty(ListItem.Property(sub_countdown)) | String.IsEqual(ListItem.Property(sub_countdown),TBA)] + !String.IsEmpty(ListItem.Property(dub_countdown)) + !String.IsEqual(ListItem.Property(dub_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(dub_countdown)]</label>
                    </control>
                </control>
                <!-- ===== /Added ===== -->

                <control type="textbox">
                    <left>300</left>
                    <top>140</top>
                    <width>450</width>
                    <height min="20" max="200">auto</height>
                    <font>font10</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>left</align>
                    <label>$INFO[ListItem.Property(plot)]</label>
                </control>
                <control type="image">
                    <left>300</left>
                    <top>350</top>
                    <width>480</width>
                    <height>30</height>
                    <texture>white.png</texture>
                    <colordiffuse>aa4da6ff</colordiffuse>
                </control>
                <control type="label">
                    <left>305</left>
                    <top>350</top>
                    <width>475</width>
                    <height>22</height>
                    <font>font10</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>center</align>
                    <label>[B]$INFO[ListItem.Property(genres)][/B]</label>
                </control>

            </itemlayout>
            <focusedlayout height="390" width="800">
                <control type="image">
                    <width>100%</width>
                    <height>100%</height>
                    <texture>white.png</texture>
                    <colordiffuse>AA000000</colordiffuse>
                </control>
                <control type="image">
                    <left>10</left>
                    <top>10</top>
                    <width>260</width>
                    <height>370</height>
                    <texture>$INFO[ListItem.Property(poster)]</texture>
                    <animation effect="zoom" end="5,5,270,380" time="100">focus</animation>
                </control>

                <!-- Vertical Ratings Group -->
                <control type="group">
                    <left>5</left>
                    <top>5</top>
                    <width>50</width>
                    <height>390</height>

                    <!-- Background rectangle -->
                    <control type="image">
                        <left>0</left>
                        <top>0</top>
                        <width>50</width>
                        <height>380</height>
                        <texture>white.png</texture>
                        <colordiffuse>CC000000</colordiffuse>
                        <animation effect="slide" end="0,0,50,390" time="100">focus</animation>
                    </control>

                    <!-- Rating Average (AniSchedule Score) -->
                    <control type="group">
                        <left>0</left>
                        <top>5</top>
                        <width>50</width>
                        <height>60</height>

                        <!-- Emoji icons -->
                        <control type="image">
                            <visible>Integer.IsGreaterOrEqual(ListItem.Property(rating_average),75)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.aver)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <control type="image">
                            <visible>Integer.IsGreater(ListItem.Property(rating_average),60) + Integer.IsLess(ListItem.Property(rating_average),75)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.averstr)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <control type="image">
                            <visible>Integer.IsGreater(ListItem.Property(rating_average),0) + Integer.IsLessOrEqual(ListItem.Property(rating_average),60)</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.aversad)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>
                        <control type="image">
                            <visible>Integer.IsEqual(ListItem.Property(rating_average),0) | IsEmpty(ListItem.Property(rating_average))</visible>
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.avernone)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <!-- Score label -->
                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_average)]</label>
                        </control>
                    </control>

                    <!-- MAL Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>65</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.mal)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_mal)]</label>
                        </control>
                    </control>

                    <!-- Anilist Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>125</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.anilist)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_anilist)]</label>
                        </control>
                    </control>

                    <!-- IMDb Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>185</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.imdb)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_imdb)]</label>
                        </control>
                    </control>

                    <!-- Trakt Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>245</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.trakt)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_trakt)]</label>
                        </control>
                    </control>

                    <!-- TMDb Rating -->
                    <control type="group">
                        <left>0</left>
                        <top>305</top>
                        <width>50</width>
                        <height>60</height>

                        <control type="image">
                            <left>5</left>
                            <top>0</top>
                            <width>40</width>
                            <height>30</height>
                            <texture>$INFO[Window().Property(texture.tmdb)]</texture>
                            <aspectratio>keep</aspectratio>
                        </control>

                        <control type="label">
                            <left>0</left>
                            <top>25</top>
                            <width>50</width>
                            <height>25</height>
                            <font>font12</font>
                            <textcolor>AAFFFFFF</textcolor>
                            <align>center</align>
                            <label>$INFO[ListItem.Property(rating_tmdb)]</label>
                        </control>
                    </control>
                </control>

                <!-- Release Title -->
                <control type="label">
                    <left>300</left>
                    <top>0</top>
                    <width>450</width>
                    <height>35</height>
                    <font>font16</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>left</align>
                    <scroll>true</scroll>
                    <autoscroll delay="4000" time="1500" repeat="5000" />
                    <label>[B]$INFO[ListItem.Property(release_title)][/B]</label>
                </control>

                <!-- ===== Added: compact episodes row (Raw | Sub | Dub) ===== -->
                <control type="group">
                    <visible>
                    Integer.IsGreater(ListItem.Property(raw_episode),0) |
                    Integer.IsGreater(ListItem.Property(sub_episode),0) |
                    Integer.IsGreater(ListItem.Property(dub_episode),0)
                    </visible>
                    <left>300</left>
                    <top>40</top>
                    <width>450</width>
                    <height>70</height>

                    <!-- RAW -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(raw_episode),0)</visible>
                        <left>0</left>
                        <top>0</top>
                        <width>150</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>150</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF53b56f</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(raw_episode)] Raw[/B]</label>
                        </control>
                        <!-- time under title -->
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(raw_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>150</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(raw_time)]</label>
                        </control>
                    </control>

                    <!-- Separator RAW|SUB -->
                    <control type="image">
                        <visible>Integer.IsGreater(ListItem.Property(raw_episode),0) + Integer.IsGreater(ListItem.Property(sub_episode),0)</visible>
                        <left>150</left>
                        <top>0</top>
                        <width>2</width>
                        <height>42</height>
                        <texture>white.png</texture>
                        <colordiffuse>33FFFFFF</colordiffuse>
                    </control>

                    <!-- SUB -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(sub_episode),0)</visible>
                        <left>152</left>
                        <top>0</top>
                        <width>150</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>150</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF2fb2ff</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(sub_episode)] Sub[/B]</label>
                        </control>
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(sub_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>150</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(sub_time)]</label>
                        </control>
                    </control>

                    <!-- Separator SUB|DUB -->
                    <control type="image">
                        <visible>Integer.IsGreater(ListItem.Property(sub_episode),0) + Integer.IsGreater(ListItem.Property(dub_episode),0)</visible>
                        <left>302</left>
                        <top>0</top>
                        <width>2</width>
                        <height>42</height>
                        <texture>white.png</texture>
                        <colordiffuse>33FFFFFF</colordiffuse>
                    </control>

                    <!-- DUB -->
                    <control type="group">
                        <visible>Integer.IsGreater(ListItem.Property(dub_episode),0)</visible>
                        <left>304</left>
                        <top>0</top>
                        <width>146</width>
                        <height>70</height>
                        <control type="label">
                            <left>0</left>
                            <top>0</top>
                            <width>146</width>
                            <height>20</height>
                            <font>font10</font>
                            <textcolor>FF9fd33a</textcolor>
                            <align>left</align>
                            <label>[B]Ep $INFO[ListItem.Property(dub_episode)] Dub[/B]</label>
                        </control>
                        <control type="label">
                            <visible>!String.IsEmpty(ListItem.Property(dub_time))</visible>
                            <left>0</left>
                            <top>22</top>
                            <width>146</width>
                            <height>18</height>
                            <font>font10</font>
                            <textcolor>FFB7C0CC</textcolor>
                            <align>left</align>
                            <label>$INFO[ListItem.Property(dub_time)]</label>
                        </control>
                    </control>

                    <!-- Single day and date below all three columns with fallback: raw → sub → dub -->
                    <!-- RAW day/date (primary) -->
                    <control type="label">
                        <visible>!String.IsEmpty(ListItem.Property(raw_day)) + !String.IsEqual(ListItem.Property(raw_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(raw_day)] $INFO[ListItem.Property(raw_date_formatted)]</label>
                    </control>
                    <!-- SUB day/date (fallback if no raw) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_day)) | String.IsEqual(ListItem.Property(raw_day),TBA)] + !String.IsEmpty(ListItem.Property(sub_day)) + !String.IsEqual(ListItem.Property(sub_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(sub_day)] $INFO[ListItem.Property(sub_date_formatted)]</label>
                    </control>
                    <!-- DUB day/date (fallback if no raw or sub) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_day)) | String.IsEqual(ListItem.Property(raw_day),TBA)] + [String.IsEmpty(ListItem.Property(sub_day)) | String.IsEqual(ListItem.Property(sub_day),TBA)] + !String.IsEmpty(ListItem.Property(dub_day)) + !String.IsEqual(ListItem.Property(dub_day),TBA)</visible>
                        <left>0</left>
                        <top>55</top>
                        <width>300</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>88B7C0CC</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(dub_day)] $INFO[ListItem.Property(dub_date_formatted)]</label>
                    </control>

                    <!-- Countdown beside date with fallback: raw → sub → dub -->
                    <!-- RAW countdown (primary) -->
                    <control type="label">
                        <visible>!String.IsEmpty(ListItem.Property(raw_countdown)) + !String.IsEqual(ListItem.Property(raw_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(raw_countdown)]</label>
                    </control>
                    <!-- SUB countdown (fallback if no raw) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_countdown)) | String.IsEqual(ListItem.Property(raw_countdown),TBA)] + !String.IsEmpty(ListItem.Property(sub_countdown)) + !String.IsEqual(ListItem.Property(sub_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(sub_countdown)]</label>
                    </control>
                    <!-- DUB countdown (fallback if no raw or sub) -->
                    <control type="label">
                        <visible>[String.IsEmpty(ListItem.Property(raw_countdown)) | String.IsEqual(ListItem.Property(raw_countdown),TBA)] + [String.IsEmpty(ListItem.Property(sub_countdown)) | String.IsEqual(ListItem.Property(sub_countdown),TBA)] + !String.IsEmpty(ListItem.Property(dub_countdown)) + !String.IsEqual(ListItem.Property(dub_countdown),TBA)</visible>
                        <left>350</left>
                        <top>55</top>
                        <width>150</width>
                        <height>18</height>
                        <font>font9</font>
                        <textcolor>FFFF9800</textcolor>
                        <align>left</align>
                        <label>$INFO[ListItem.Property(dub_countdown)]</label>
                    </control>
                </control>
                <!-- ===== /Added ===== -->

                <control type="textbox">
                    <left>300</left>
                    <top>140</top>
                    <width>450</width>
                    <height min="20" max="200">auto</height>
                    <font>font10</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>left</align>
                    <autoscroll delay="3000" time="1500" repeat="5000"></autoscroll>
                    <label>$INFO[ListItem.Property(plot)]</label>
                </control>
                <control type="image">
                    <left>300</left>
                    <top>350</top>
                    <width>480</width>
                    <height>30</height>
                    <texture>white.png</texture>
                    <colordiffuse>aa4da6ff</colordiffuse>
                </control>
                <control type="label">
                    <left>305</left>
                    <top>350</top>
                    <width>475</width>
                    <height>22</height>
                    <font>font10</font>
                    <textcolor>AAFFFFFF</textcolor>
                    <align>center</align>
                    <label>[B]$INFO[ListItem.Property(genres)][/B]</label>
                </control>

            </focusedlayout>
        </control>

        <!-- DEBUG: Layout grid (commented out) -->
        <!--<control type="image">-->
        <!--<width>100%</width>-->
        <!--<height>100%</height>-->
        <!--<texture>$INFO[Window(13000).Property(test_pattern)]</texture>-->
        <!--<colordiffuse>55FFFFFF</colordiffuse>-->
        <!--</control>-->
    </controls>
</window>

<!--
╔═══════════════════════════════════════════════════════════════════════════╗
║                          FILE NAVIGATION GUIDE                            ║
╠═══════════════════════════════════════════════════════════════════════════╣
║                                                                           ║
║  📍 QUICK JUMP TO SECTIONS:                                              ║
║  ────────────────────────────────────────────────────────────────────── ║
║  Line ~1-30    : Header comments & window setup                          ║
║  Line ~30-95   : Background layers (fanart, overlays, logo)              ║
║  Line ~95-700  : ITEMLAYOUT (unfocused anime cards)                      ║
║  Line ~700-1280: FOCUSEDLAYOUT (focused card with zoom animation)        ║
║  Line ~1310+   : Debug grid (commented out)                              ║
║                                                                           ║
║  🎨 LAYOUT STRUCTURE (both itemlayout & focusedlayout):                  ║
║  ────────────────────────────────────────────────────────────────────── ║
║  1. Poster Image (260x370px, left: 10px)                                 ║
║  2. Vertical Ratings Bar (50px wide, overlays left edge of poster)       ║
║     ├─ Rating Average (0-100%, emoji icons)                              ║
║     ├─ MAL Rating (0-10)                                                 ║
║     ├─ AniList Rating (0-10)                                             ║
║     ├─ IMDb Rating (0-10)                                                ║
║     ├─ Trakt Rating (0-10)                                               ║
║     └─ TMDb Rating (0-10)                                                ║
║  3. Title (left: 300px, scrolling text)                                  ║
║  4. Episode Info Row (RAW | SUB | DUB)                                   ║
║     ├─ Episode numbers with colors (green/blue/yellow)                   ║
║     ├─ Release times (under each type)                                   ║
║     ├─ Day/Date (shared, fallback priority: raw→sub→dub)                ║
║     └─ Countdown timers (shared, fallback priority: raw→sub→dub)        ║
║  5. Plot/Description (textbox, auto-height)                              ║
║  6. Genres Bar (purple background with centered text)                    ║
║                                                                           ║
║  🔑 KEY PROPERTIES USED:                                                  ║
║  ────────────────────────────────────────────────────────────────────── ║
║  • release_title          - Anime title (respects user language pref)    ║
║  • poster                 - Poster image URL                             ║
║  • rating_average         - Average score (0-100%, MDBList/AniList)      ║
║  • rating_mal             - MyAnimeList score (0-10 or "-")              ║
║  • rating_anilist         - AniList score (0-10 or "-")                  ║
║  • rating_imdb            - IMDb score (0-10 or "-")                     ║
║  • rating_trakt           - Trakt score (0-10 or "-")                    ║
║  • rating_tmdb            - TMDb score (0-10 or "-")                     ║
║  • raw_episode            - Next RAW episode number                      ║
║  • sub_episode            - Next SUB episode number                      ║
║  • dub_episode            - Next DUB episode number                      ║
║  • raw_time               - RAW episode time (e.g., "03:00 PM")          ║
║  • sub_time               - SUB episode time                             ║
║  • dub_time               - DUB episode time                             ║
║  • raw_day                - RAW episode day (e.g., "Thursday")           ║
║  • sub_day                - SUB episode day                              ║
║  • dub_day                - DUB episode day                              ║
║  • raw_date_formatted     - RAW episode date (e.g., "06 Nov")            ║
║  • sub_date_formatted     - SUB episode date                             ║
║  • dub_date_formatted     - DUB episode date                             ║
║  • raw_countdown          - RAW countdown (e.g., "5h 23m") 🔄 DYNAMIC!   ║
║  • sub_countdown          - SUB countdown 🔄 DYNAMIC!                    ║
║  • dub_countdown          - DUB countdown 🔄 DYNAMIC!                    ║
║  • plot                   - Anime description                            ║
║  • genres                 - Comma-separated genre list                   ║
║                                                                           ║
║  ⚡ IMPORTANT: COUNTDOWN TIMERS ARE DYNAMIC!                             ║
║  ────────────────────────────────────────────────────────────────────── ║
║  The countdown properties (raw_countdown, sub_countdown, dub_countdown)  ║
║  are calculated FRESH every time the window opens. They are NOT cached!  ║
║                                                                           ║
║  How it works:                                                            ║
║  1. Cache stores: episode_date timestamp (e.g., "2025-11-10T20:00:00Z")  ║
║  2. Python calculates: current_time - episode_date = countdown           ║
║  3. Result: Always accurate countdown (e.g., "5h 23m" or "Released")     ║
║                                                                           ║
║  This means:                                                              ║
║  ✅ User opens calendar at 2:00 PM → "6h 0m until 8:00 PM episode"      ║
║  ✅ User opens again at 6:00 PM → "2h 0m until 8:00 PM episode"         ║
║  ✅ Cache can last 24 hours, countdowns stay fresh!                      ║
║                                                                           ║
║  🎨 COLOR CODES:                                                          ║
║  ────────────────────────────────────────────────────────────────────── ║
║  • FF53b56f (green)  - RAW episodes                                      ║
║  • FF2fb2ff (blue)   - SUB episodes                                      ║
║  • FF9fd33a (yellow) - DUB episodes                                      ║
║  • FFFF9800 (orange) - Countdown timers                                  ║
║  • AA4da6ff (purple) - Genre bar background                              ║
║  • AAFFFFFF (white)  - General text (70% opacity)                        ║
║  • 88B7C0CC (gray)   - Secondary text (53% opacity)                      ║
║                                                                           ║
║  📐 DIMENSIONS:                                                           ║
║  ────────────────────────────────────────────────────────────────────── ║
║  • Window: 1920x1080 (full screen)                                       ║
║  • Panel container: 1700x900 (left: 120, top: 100)                       ║
║  • Card size: 800x390 (each anime item)                                  ║
║  • Poster: 260x370                                                       ║
║  • Ratings bar: 50x430 (overlays poster left edge)                       ║
║  • Each rating slot: 50x60 (icon 40x30, label below)                     ║
║                                                                           ║
║  🔧 EDITING TIPS:                                                         ║
║  ────────────────────────────────────────────────────────────────────── ║
║  • itemlayout & focusedlayout are nearly identical - edit both!          ║
║  • To change rating order: adjust <top> values (70, 135, 200, 265, 330) ║
║  • Episode row starts at <top>40</top> below title                       ║
║  • Countdown fallback logic: raw → sub → dub (uses first available)     ║
║  • Focused layout adds zoom animation: effect="zoom" end="5,5,270,380"  ║
║                                                                           ║
╚═══════════════════════════════════════════════════════════════════════════╝
-->
